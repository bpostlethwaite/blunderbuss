<h1>blunderbuss</h1>
<p>Blunderbuss is a <a href="https://github.com/senchalabs/connect">Connect</a> like middleware system for stacking together distributed services that pass data via event emitters. This is accomplished with <a href="https://github.com/substack/dnode">Substack&#39;s DNode</a> project to pass data between services and client. Event emitters pass data between the client facing service API&#39;s within Blunderbuss. Easy start and finish functions allow for pre and post logic as well as creating circular service chains for repetitive or additive tasks.

</p>
<p>On the <code>Server</code> service, do:
```javascript
var dnode = require(&#39;dnode&#39;)
/<em>
 </em> Define service functions.
 <em> These would usually be distributed
 </em> over processes or machines etc.
 <em>/
function doubleIt(json, cb) {
  json.data </em>= 2
  cb(null, json)
}
function dupField(json, cb) {
  json.data2 = json.data
  cb(null, json)
}
function sumFields(json, cb) {
  json.total = json.data2 + json.data
  cb(null, json)
}


</p>
<p>// Start Service Servers
var server = dnode({
  service : doubleIt
})
server.listen(5001)
var server2 = dnode({
  service : dupField
})
server2.listen(5002)
var server3 = dnode({
  service : sumFields
})
server3.listen(5003)
```

</p>
<p>Though you would usually want to define
these services independantly in their own
processes or machines.

</p>
<p>On the <code>Client</code>, do:
```javascript
var ss = require(&quot;../&quot;)()

</p>
<p>var services = {
  &quot;doubleIt&quot;: 5001
, &quot;dupField&quot;: 5002
, &quot;sumFields&quot;: 5003
}


</p>
<p>ss.register(services)
ss.start({&quot;data&quot;: 1})

</p>
<p>var totalrep = 3
var rep = 0

</p>
<p>/<em>
 </em> Calling ss.start in the finish callback
 <em> and passing in the accumulated data
 </em> sets up a repetition for an assembly line
 <em> style service structure.
 </em>/
ss.finish(function (data) {
  rep++
  console.log(data)
  if (rep === totalrep) {
    process.exit(1)
  }
  ss.start(data)
})
```

</p>
<p>which outputs
<code>shell
{ data: 2, data2: 2, total: 4 }
{ data: 4, data2: 4, total: 8 }
{ data: 8, data2: 8, total: 16 }
</code>

</p>
